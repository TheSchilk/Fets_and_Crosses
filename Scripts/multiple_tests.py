from Utils.board import board
import sys
from Utils.select_engine import select_engine
from Engines.EngineError import EngineError
engine = select_engine(sys.argv)

tests = [
    # Win - Rows
    [[0, 2, 2, 0, 0, 0, 0, 0, 0], 0],
    [[2, 0, 2, 0, 0, 0, 0, 0, 0], 1],
    [[2, 2, 0, 0, 0, 0, 0, 0, 0], 2],

    [[0, 0, 0, 0, 2, 2, 0, 0, 0], 3],
    [[0, 0, 0, 2, 0, 2, 0, 0, 0], 4],
    [[0, 0, 0, 2, 2, 0, 0, 0, 0], 5],

    [[0, 0, 0, 0, 0, 0, 0, 2, 2], 6],
    [[0, 0, 0, 0, 0, 0, 2, 0, 2], 7],
    [[0, 0, 0, 0, 0, 0, 2, 2, 0], 8],

    # Win - Cols
    [[0, 0, 0, 2, 0, 0, 2, 0, 0], 0],
    [[2, 0, 0, 0, 0, 0, 2, 0, 0], 3],
    [[2, 0, 0, 2, 0, 0, 0, 0, 0], 6],

    [[0, 0, 0, 0, 2, 0, 0, 2, 0], 1],
    [[0, 2, 0, 0, 0, 0, 0, 2, 0], 4],
    [[0, 2, 0, 0, 2, 0, 0, 0, 0], 7],

    [[0, 0, 0, 0, 0, 2, 0, 0, 2], 2],
    [[0, 0, 2, 0, 0, 0, 0, 0, 2], 5],
    [[0, 0, 2, 0, 0, 2, 0, 0, 0], 8],

    # Win - Diags
    [[0, 0, 0, 0, 2, 0, 0, 0, 2], 0],
    [[2, 0, 0, 0, 0, 0, 0, 0, 2], 4],
    [[2, 0, 0, 0, 2, 0, 0, 0, 0], 8],

    [[0, 0, 0, 0, 2, 0, 2, 0, 0], 2],
    [[0, 0, 2, 0, 0, 0, 2, 0, 0], 4],
    [[0, 0, 2, 0, 2, 0, 0, 0, 0], 6],

    # Block - Rows
    [[0, 1, 1, 0, 0, 0, 0, 0, 0], 0],
    [[1, 0, 1, 0, 0, 0, 0, 0, 0], 1],
    [[1, 1, 0, 0, 0, 0, 0, 0, 0], 2],

    [[0, 0, 0, 0, 1, 1, 0, 0, 0], 3],  # ERR
    [[0, 0, 0, 1, 0, 1, 0, 0, 0], 4],
    [[0, 0, 0, 1, 1, 0, 0, 0, 0], 5],  # ERR

    [[0, 0, 0, 0, 0, 0, 0, 1, 1], 6],
    [[0, 0, 0, 0, 0, 0, 1, 0, 1], 7],
    [[0, 0, 0, 0, 0, 0, 1, 1, 0], 8],

    # Block - Cols
    [[0, 0, 0, 1, 0, 0, 1, 0, 0], 0],
    [[1, 0, 0, 0, 0, 0, 1, 0, 0], 3],
    [[1, 0, 0, 1, 0, 0, 0, 0, 0], 6],

    [[0, 0, 0, 0, 1, 0, 0, 1, 0], 1],  # ERR
    [[0, 1, 0, 0, 0, 0, 0, 1, 0], 4],
    [[0, 1, 0, 0, 1, 0, 0, 0, 0], 7],  # ERR

    [[0, 0, 0, 0, 0, 1, 0, 0, 1], 2],
    [[0, 0, 1, 0, 0, 0, 0, 0, 1], 5],
    [[0, 0, 1, 0, 0, 1, 0, 0, 0], 8],

    # Block - Diags
    [[0, 0, 0, 0, 1, 0, 0, 0, 1], 0],
    [[1, 0, 0, 0, 0, 0, 0, 0, 1], 4],
    [[1, 0, 0, 0, 1, 0, 0, 0, 0], 8],

    [[0, 0, 0, 0, 1, 0, 1, 0, 0], 2],
    [[0, 0, 1, 0, 0, 0, 1, 0, 0], 4],
    [[0, 0, 1, 0, 1, 0, 0, 0, 0], 6],

]


engine_player = 2


engine.open()

try:
    for test in tests:
        try:
            resp = engine.respond(board(test[0]), 2)
            if resp != test[1]:
                print("Error after %s, expected %i, got %i" %
                      (test[0], test[1], resp))
            else:
                print("OK: %s, got %i" % (test[0], resp))
        except EngineError:
            print("Error after %s, expected %i, got engine error.." %
                  (test[0], test[1]))
finally:
    engine.close()
